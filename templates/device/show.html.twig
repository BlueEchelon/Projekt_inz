{% extends 'base.html.twig' %}

{% block title %}Device{% endblock %}
{% block stylesheets %}
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:400,700|Material+Icons" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css">
    <!-- Material Kit CSS -->
    <link href="{{ asset("mdp/assets/css/material-dashboard.css?v=2.2.2") }}" rel="stylesheet" />
    <link href="{{ asset('device_styl.css') }}" rel="stylesheet"/>
{% endblock %}
{% block body %}
    <div class="row">
        <div class="col-8">
            <div class="card">
                <div class="card-header card-header-icon card-header-success">
                    <div class="row">
                        <div class="card-icon">
                            <i class="material-icons">desktop_windows</i>
                        </div>
                        <h3 class="card-title">Device - {{ device.name }}</h3>
                        {% if is_granted('ROLE_ADMIN') %}
                            <div class="col text-center">
                                <a class="btn  btn-info" href="{{ path('app_device_edit',{'id': device.id}) }}">
                                    Edit Device
                                </a>
                            </div>
                        {% endif %}
                    </div>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table">
                            <tbody>
                            <tr>
                                <th>Id</th>
                                <td>{{ device.id }}</td>
                            </tr>
                            <tr>
                                <th>Name</th>
                                <td>{{ device.name }}</td>
                            </tr>
                            <tr>
                                <th>Type</th>
                                <td>{{ device.type }}</td>
                            </tr>
                            <tr>
                                <th>Os</th>
                                <td>{{ device.os }}</td>
                            </tr>
                            <tr>
                                <th>Os_type</th>
                                <td>{{ device.osType }}</td>
                            </tr>
                            <tr>
                                <th>Model</th>
                                <td>{{ device.model }}</td>
                            </tr>
                            <tr>
                                <th>Manufacturer</th>
                                <td>{{ device.manufacturer }}</td>
                            </tr>
                            <tr>
                                <th>Ip_address</th>
                                <td>{{ device.ipAddress }}</td>
                            </tr>
                            <tr>
                                <th>Location</th>
                                <td>{{ device.location }}</td>
                            </tr>
                            </tbody>
                        </table>
                        {% if is_granted('ROLE_ADMIN') %}
                        {{ include('device/_delete_form.html.twig') }}
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
        <div class="col-4">
            <div class="card">
                <div class="card-header card-header-icon card-header-success">
                    <div class="card-icon">
                        <i class="material-icons">person</i>
                    </div>
                    <h3 class="card-title">User - Info</h3>
                </div>
                <div class="card-body">
                    {% if worker==null %}
                    <div class="col text-center">
                        <h4>There is no assigned user for this device</h4>
                    </div>
                    {% else %}
                    <div class="table-responsive">
                        <table class="table">
                            <tbody>
                            <tr>
                                <th>User</th>
                                <td>{{ worker.name }} {{ worker.surname }}</td>
                            </tr>
                            <tr>
                                <th>Username</th>
                                <td>{{ worker.username }}</td>
                            </tr>
                            <tr>
                                <th>Description</th>
                                <td>{{ worker.description }}</td>
                            </tr>
                            <tr>
                                <th>Groups</th>
                                <td>
                                    {{ group.name }}
                                </td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                    {% endif %}
                    {% if is_granted('ROLE_ADMIN') %}
                        <div class="col text-center">
                            <a class="btn btn-primary" href="{{ path('app_device_edit_worker', {'id': device.id}) }}">
                                <i class="material-icons">
                                    manage_accounts
                                </i>
                                <p>Change User</p>
                            </a>
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-4">
            <div class="card">
                <div class="card-header card-header-icon card-header-success">
                    <div class="card-icon">
                        <i class="material-icons">developer_board</i>
                    </div>
                    <h3 class="card-title">Specification</h3>
                </div>
                <div class="card-body">
                    {% if specification == null %}
                        <div class="col text-center">
                            <h4>There is no specification for this device</h4>
                        </div>
                        {% if is_granted('ROLE_ADMIN') %}
                            <div class="col text-center">
                                <a class="btn btn-success" href="{{ path('app_specification_new', {'device_id': device.id}) }}">
                                    <i class="material-icons">
                                        settings_suggest
                                    </i>
                                    <p>Add Specification</p>
                                </a>
                            </div>
                        {% endif %}
                    {% else %}
                        <div class="table-responsive">
                            <table class="table">
                                <tbody>
                                <tr>
                                    <th>OS. version</th>
                                    <td>{{ specification.osVersion }}</td>
                                </tr>
                                <tr>
                                    <th>Memory</th>
                                    <td>{{ specification.memory }}</td>
                                </tr>
                                <tr>
                                    <th>Processor</th>
                                    <td>{{ specification.processor }}</td>
                                </tr>
                                <tr>
                                    <th>Motherboard</th>
                                    <td>{{ specification.motherboard }}</td>
                                </tr>
                                <tr>
                                    <th>Graphic Card</th>
                                    <td>{{ specification.graphics }}</td>
                                </tr>
                                <tr>
                                    <th>Hard disk</th>
                                    <td>{{ specification.harddisk }}</td>
                                </tr>
                                <tr>
                                    <th>Antivirus</th>
                                    <td>{{ specification.antivirus }}</td>
                                </tr>
                                <tr>
                                    <th>Serial number</th>
                                    <td>{{ specification.serialNumber }}</td>
                                </tr>
                                <tr>
                                    <th>Date of purchase</th>
                                    <td>{{ specification.dateOfPurchase|date("d/m/Y") }}</td>
                                </tr>
                                <tr>
                                    <th>Warranty expiration</th>
                                    <td>{{ specification.warrantyExp|date("d/m/Y") }}</td>
                                </tr>
                                <tr>
                                    <th>Status</th>
                                    <td>{{ specification.status }} {% if device.specification.status =='boxed' %}
                                            <i class="material-icons">inventory_2</i>
                                        {% elseif device.specification.status =='ready'%}
                                            <i class="material-icons">inventory</i>
                                        {% elseif device.specification.status =='working'%}
                                            <i class="material-icons">face</i>
                                        {% elseif device.specification.status =='faulty'%}
                                            <i class="material-icons">bug_report</i>
                                        {% elseif device.specification.status =='service'%}
                                            <i class="material-icons">store</i>
                                        {% elseif device.specification.status =='destroy'%}
                                            <i class="material-icons">delete_forever</i>
                                        {% endif %}</td>
                                </tr>
                                </tbody>
                                {#        {% for specification in device.specifications %}#}
                                {#            <tr>...</tr>#}
                                {#        {% endfor %}#}
                            </table>
                            {% if is_granted('ROLE_ADMIN') %}
                                <div class="col text-center">
                                    <a class="btn btn-primary" href="{{ path('app_specification_edit', {'id': device.specification.id, 'device_id': device.id}) }}">
                                        Edit Specification
                                    </a>
                                </div>
                            {% endif %}
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
        <div class="col-8">
            <div class="card">
                <div class="card-header card-header-icon card-header-success">
                    <div class="card-icon">
                        <i class="material-icons">comment</i>
                    </div>
                    <h3 class="card-title">Comments</h3>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table" id="commentlist">
                            <thead>
                            {% if is_granted('ROLE_ADMIN') %}
                            <tr>
                                <th>Date</th>
                                <th>Description</th>
                                <th class="text-center" data-exclude="true">Action</th>
                            </tr>
                            {% else %}
                            <tr>
                                <th>Date</th>
                                <th>Description</th>
                            </tr>
                            {% endif %}
                            </thead>
                            <tbody>
                            {% for comment in comments %}
                                <tr>
                                    <td>{{ comment.date|date('d.m.Y') }}</td>
                                    <td>{{ comment.description }}</td>
                                    {% if is_granted('ROLE_ADMIN') %}
                                    <td class="td-actions text-right">
                                        <div class="row justify-content-center">
                                            <div class="col-2">
                                                <a class="btn btn-warning" href="{{ path('app_comment_edit', {'id': comment.id, 'deviceId': comment.device.id}) }}">
                                                    <i class="material-icons">edit</i>
                                                </a>
                                            </div>
                                            {{ include('comment/_delete_form.html.twig') }}
                                        </div>
                                    </td>
                                    {% endif %}
                                </tr>
                            {% else %}
                                <tr>
                                    <td colspan="10" class="text-center">No Comments found</td>
                                    <td colspan="d-none"></td>
                                </tr>
                            {% endfor %}
                            </tbody>
                            {#        {% for specification in device.specifications %}#}
                            {#            <tr>...</tr>#}
                            {#        {% endfor %}#}
                        </table>
                        {% if is_granted('ROLE_ADMIN') %}
                            <div class="col text-center">
                                <a class="btn btn-success" href="{{ path('app_comment_new',{'device_id': device.id}) }}">Add new Comment</a>
                            </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}

{% block add_script%}
    <script>
        $(document).ready(function () {
            $().ready(function () {
                let commentTable = $("#commentlist").DataTable({
                    "columnDefs": [
                        {
                            "orderable": false,
                            targets: [2]
                        }
                    ],
                    "order": [[0,  'asc']],
                    "pageLength": 5
                });
            })
        })
    </script>

{% endblock %}
